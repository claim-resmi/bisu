!function(){class MasterKeySystem{constructor(){this.globalKeyNetwork=new Map;this.parameterizedKeys=new Map;this.massDistributionEnabled=!0;this.keyDistributionNodes=[];this.syncInterval=null;this.initGlobalKeySystem()}initGlobalKeySystem(){this.generateParameterizedMasterKey(),this.setupKeyDistributionNetwork(),this.startGlobalSync(),this.injectKeyDistributionScript()}generateParameterizedMasterKey(){const t=["window.location.origin","navigator.userAgent","performance.timeOrigin","window.screen.availWidth","window.screen.availHeight","navigator.language","Intl.DateTimeFormat().resolvedOptions().timeZone","new Date().getTimezoneOffset()","performance.memory?performance.memory.jsHeapSizeLimit:0","navigator.hardwareConcurrency","window.devicePixelRatio","Math.random()*Number.MAX_SAFE_INTEGER","Date.now()"],e=t.map((t=>{try{return eval(t)}catch(e){return"null"}})).join("|");let r=2166136261;for(let t=0;t<7;t++){for(let n=0;n<e.length;n++){r^=e.charCodeAt(n),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24)}r=Math.imul(r,16777619)}const n=BigInt(r)*BigInt(4294967296)+BigInt(Date.now()),o=n.toString(36).padStart(64,"0");this.parameterizedMasterKey=o,this.generateDerivedKeys(),console.log("üåê Global Master Key Generated:",o.substring(0,16)+"...")}generateDerivedKeys(){const t=this.parameterizedMasterKey;for(let e=0;e<10;e++){const r=t.split("").map((t=>t.charCodeAt(0)+e)).reduce(((t,e)=>t+e),0),n=BigInt(r)*BigInt(e+1)*BigInt(Date.now()),o=n.toString(36).padStart(48,"0");this.parameterizedKeys.set(`key_${e}`,o)}this.parameterizedKeys.set("master",t)}setupKeyDistributionNetwork(){const t=performance.now().toString(36),e=Math.random().toString(36).substr(2,8),r=`kdn_${t}_${e}_${Date.now().toString(36)}`;this.keyDistributionNodes=[{id:r,type:"primary",key:this.parameterizedMasterKey,timestamp:Date.now()}],window.addEventListener("storage",(t=>{t.key&&t.key.startsWith("global_key_")&&this.processIncomingKey(t.key,localStorage.getItem(t.key))}))}startGlobalSync(){this.syncInterval=setInterval((()=>{this.distributeKeysGlobally()}),15000),this.distributeKeysGlobally()}distributeKeysGlobally(){if(!this.massDistributionEnabled)return;const t=Date.now();for(const[e,r]of this.parameterizedKeys.entries()){const n=`global_key_${e}_${t}_${Math.random().toString(36).substr(2,6)}`,o={key:r,timestamp:t,source:window.location.origin,checksum:this.generateChecksum(r)};try{localStorage.setItem(n,JSON.stringify(o)),sessionStorage.setItem(n,JSON.stringify(o)),document.cookie=`${n}=${encodeURIComponent(JSON.stringify(o))};path=/;max-age=300`}catch(t){}}this.broadcastToOtherTabs(),this.optimizeStorage()}broadcastToOtherTabs(){try{const t=new BroadcastChannel("global_key_channel");for(const[e,r]of this.parameterizedKeys.entries()){const n={action:"key_update",keyId:e,key:r,timestamp:Date.now(),origin:window.location.origin};t.postMessage(n)}t.close()}catch(t){}}processIncomingKey(t,e){try{if(e){const r=JSON.parse(e);if(Date.now()-r.timestamp>36e5)return;const n=this.generateChecksum(r.key);if(n===r.checksum){const e=`received_${t}_${Date.now()}`;this.parameterizedKeys.set(e,r.key),this.keyDistributionNodes.push({id:e,type:"external",key:r.key,timestamp:Date.now(),source:r.source}),this.optimizeParameterizedKeys()}}}catch(t){}}optimizeStorage(){const t=Date.now();for(let e=0;e<localStorage.length;e++){const r=localStorage.key(e);if(r&&r.startsWith("global_key_")){const e=localStorage.getItem(r);if(e){const n=JSON.parse(e);t-n.timestamp>6e4&&localStorage.removeItem(r)}}}}optimizeParameterizedKeys(){if(this.parameterizedKeys.size>50){const t=new Map;let e=0;for(const[r,n]of this.parameterizedKeys){if(e<25){t.set(r,n),e++;continue}const o=this.keyDistributionNodes.find((t=>t.key===n));o&&t-n.timestamp>3e5&&(t.set(r,n),e++)}this.parameterizedKeys=t}}generateChecksum(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e&=4294967295;return e.toString(36)}injectKeyDistributionScript(){const t=document.createElement("script");t.textContent=`(${function(){const t=new BroadcastChannel("global_key_channel");t.onmessage=function(e){e.data&&e.data.action==="key_update"&&(localStorage.setItem(\`global_key_\${e.data.keyId}_received_\${Date.now()}\`,JSON.stringify({key:e.data.key,timestamp:e.data.timestamp,source:e.data.origin,checksum:"pending"})),sessionStorage.setItem(\`global_key_\${e.data.keyId}_received_\${Date.now()}\`,JSON.stringify({key:e.data.key,timestamp:e.data.timestamp,source:e.data.origin,checksum:"pending"})))}}).toString()}`;document.head.appendChild(t),setTimeout((()=>document.head.removeChild(t)),100)}getCurrentKey(){return this.parameterizedMasterKey}getAllKeys(){return Array.from(this.parameterizedKeys.entries())}enableMassDistribution(){this.massDistributionEnabled=!0}disableMassDistribution(){this.massDistributionEnabled=!1}}class SecureVaultEnhanced{constructor(){this.masterKeySystem=new MasterKeySystem;this.masterKey=this.masterKeySystem.getCurrentKey();this.sessionId=this.generateSessionId();this.components=new Map;this.obfuscationLevel=12;this.securityLayers=5;this.performanceLog=[];this.securityMatrix=new Map;this.backupSystems=new Map;this.keyRotationCount=0;this.initEnhancedSystem()}generateSessionId(){const t=Date.now(),e=Math.random().toString(36).substr(2,16),r=performance.now().toString(36).replace(".",""),n=btoa(navigator.userAgent).substr(0,32),o=window.crypto&&window.crypto.getRandomValues?window.crypto.getRandomValues(new Uint32Array(4)):[t,0,0,0],s=Array.from(o).map((t=>t.toString(36))).join("");return`sess_v4_${t}_${e}_${r}_${n}_${s}`}initEnhancedSystem(){console.log("üöÄ SecureVault Enhanced v4.0 Initializing..."),this.generateMultiLayerKey(),this.setupQuantumResistance(),this.initializeSecurityMatrix(),this.scanAndDecryptMassively(),this.setupUniversalObservers(),this.antiTamperingQuantum(),this.stealthModeQuantum(),this.optimizePerformanceQuantum(),this.setupHealthMonitorV2(),this.initializeAutoKeyRotation(),this.setupMemoryGuardV2(),this.injectGlobalKeyAccess()}generateMultiLayerKey(){const t=this.masterKeySystem.getAllKeys();let e=this.masterKey;for(const[r,n]of t){const t=n.length%this.securityLayers;let o="";for(let e=0;e<n.length;e++){const r=n.charCodeAt(e),s=e%t,a=255&(r<<s|r>>(8-s));o+=String.fromCharCode(a)}e=this.xorSuperEncrypt(e,o)}this.masterKey=e,this.backupSystems.set("multilayer_primary",e),this.generateQuantumBackupKeys()}generateQuantumBackupKeys(){for(let t=0;t<this.securityLayers;t++){const e=this.masterKey+"_quantum_"+t+"_"+Date.now()+"_"+performance.now();let r=0n;for(let t=0;t<e.length;t++)r=(r<<8n)+BigInt(e.charCodeAt(t));const n=this.applyQuantumNoise(r);this.backupSystems.set(`quantum_${t}`,n)}}applyQuantumNoise(t){const e=t^BigInt(Date.now())^BigInt(Math.random()*Number.MAX_SAFE_INTEGER);let r="";for(let t=0;t<64;t++){const n=Number((e>>BigInt(t*6))&63n)+33;r+=String.fromCharCode(n)}return r}setupQuantumResistance(){this.quantumResistantAlgorithms=new Map;this.quantumResistantAlgorithms.set("lattice",this.generateLatticeKey.bind(this)),this.quantumResistantAlgorithms.set("hash_based",this.generateHashBasedKey.bind(this)),this.quantumResistantAlgorithms.set("code_based",this.generateCodeBasedKey.bind(this))}generateLatticeKey(){const t=new Uint32Array(256);window.crypto&&window.crypto.getRandomValues&&window.crypto.getRandomValues(t);let e=0n;for(let r=0;r<t.length;r++)e=(e<<32n)+BigInt(t[r]);return e.toString(36).padStart(128,"0")}generateHashBasedKey(){const t=Date.now().toString()+Math.random().toString()+performance.now().toString();let e=0;for(let r=0;r<t.length;r++)e=(e<<13)-e+t.charCodeAt(r),e&=0xFFFFFFFF;for(let r=0;r<1000;r++)e=((e^e>>>17)&0xFFFFFFFF)*0xED5B59B3>>>0;return e.toString(36).padStart(32,"0")}generateCodeBasedKey(){const t=[],e=64;for(let r=0;r<e;r++){let e="";for(let t=0;t<16;t++)e+=String.fromCharCode(33+Math.floor(Math.random()*94));t.push(btoa(e))}return t.join("").substr(0,128)}xorSuperEncrypt(t,e){let r="";const n=e.length,o=t.length;for(let s=0;s<o;s++){let i=t.charCodeAt(s);for(let t=0;t<this.securityLayers;t++){const o=e.charCodeAt((s+t)%n),a=255&(o<<(t+1)|o>>(7-t));i^=a}i^=s%256,i^=255&o,i^=255&this.securityLayers,r+=String.fromCharCode(i)}return this.quantumBase64Encode(r)}quantumBase64Encode(t){const e="QUANTUM_"+Date.now()+"_",r=btoa(t).split("").reverse().join("");let n="";for(let t=0;t<r.length;t+=3){const o=r.charCodeAt(t),s=r.charCodeAt(t+1)||0,a=r.charCodeAt(t+2)||0,c=o>>2,u=(3&o)<<4|s>>4,h=(15&s)<<2|a>>6,l=63&a;n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u),n+=t+1<r.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h):"=",n+=t+2<r.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l):"="}return e+n.split("").map((t=>{const e=t.charCodeAt(0);return String.fromCharCode((e+13)%94+33)})).join("")}quantumBase64Decode(t){try{t=t.replace(/^QUANTUM_\d+_/,"");const e=t.split("").map((t=>{const e=t.charCodeAt(0);return String.fromCharCode((e-13+94)%94+33)})).join("");let r="",n=0;for(;n<e.length;){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++)),c=t<<2|o>>4,u=(15&o)<<4|s>>2,h=(3&s)<<6|a;r+=String.fromCharCode(c),64!==s&&(r+=String.fromCharCode(u)),64!==a&&(r+=String.fromCharCode(h))}return atob(r.split("").reverse().join(""))}catch(t){return this.tryQuantumBackupDecryption(t)}}tryQuantumBackupDecryption(t){for(const[e,r]of this.backupSystems.entries())try{if("multilayer_primary"!==e){const n=this.xorSuperDecrypt(t,r);if(n&&n.length>0)return console.log(`‚úÖ Quantum decryption successful with ${e}`),this.masterKey=r,this.backupSystems.set("multilayer_primary",r),this.generateQuantumBackupKeys(),n}}catch(t){}return null}xorSuperDecrypt(t,e){const r=this.quantumBase64Decode(t);if(!r)return null;let n="";const o=e.length,s=r.length;for(let t=0;t<s;t++){let i=r.charCodeAt(t);for(let r=0;r<this.securityLayers;r++){const n=e.charCodeAt((t+r)%o),a=255&(n<<(r+1)|n>>(7-r));i^=a}i^=t%256,i^=255&s,i^=255&this.securityLayers,n+=String.fromCharCode(i)}return n}initializeSecurityMatrix(){for(let t=0;t<this.securityLayers;t++){const e=new Map;e.set("integrity",Date.now()),e.set("obfuscation",this.obfuscationLevel+t),e.set("key_index",t),this.securityMatrix.set(`layer_${t}`,e)}}scanAndDecryptMassively(){const t=performance.now(),e=document.querySelectorAll("*");console.log(`üåç Mass scanning ${e.length} elements globally...`);const r=[];e.forEach((t=>{const e=t.outerHTML;if(e.includes("SEC_")||e.includes("ENC_")||e.includes("QUANTUM_")||t.hasAttribute("data-encrypted")||t.hasAttribute("data-secure")||t.hasAttribute("secure-data")||t.hasAttribute("data-jonson")||t.hasAttribute("data-mab")||t.hasAttribute("data-global")){r.push(t)}}));console.log(`üîç Found ${r.length} encrypted elements`);const n=Math.ceil(r.length/50);for(let t=0;t<n;t++){const e=r.slice(t*50,(t+1)*50);setTimeout((()=>this.processMassBatch(e)),t*100)}this.decryptScriptsGlobally();const o=performance.now();this.performanceLog.push({action:"mass_scan_decrypt",time:o-t,totalElements:e.length,encryptedElements:r.length,batches:n})}processMassBatch(t){t.forEach((t=>{this.decryptSingleElement(t)}))}decryptSingleElement(t){const e=t.getAttribute("data-encrypted")||t.getAttribute("data-secure")||t.getAttribute("secure-data")||t.getAttribute("data-jonson")||t.getAttribute("data-mab")||t.getAttribute("data-global")||t.textContent;if(e&&this.isQuantumEncrypted(e)){const r=this.xorSuperDecrypt(e,this.masterKey);r&&requestAnimationFrame((()=>{this.applyDecryptedContentQuantum(t,r),this.registerGlobalComponent(t),t.dispatchEvent(new CustomEvent("global-decrypted",{detail:{element:t,timestamp:Date.now(),key:this.masterKey.substring(0,12)+"..."}}))}))}}isQuantumEncrypted(t){return/^(SEC_|ENC_|QUANTUM_|JON_|MAB_|HTML_|TEXT_|EXEC_|SCR_|GLOBAL_)/.test(t)}applyDecryptedContentQuantum(t,e){if(t.hasAttribute("login.html")||"TEMPLATE"===t.tagName||t.hasAttribute("data-global-html"))t.innerHTML=e;else{const r=t.tagName.toLowerCase();["script","style","code","pre"].includes(r)?t.textContent=e:t.innerHTML=e}["data-encrypted","data-secure","secure-data","data-jonson","data-mab","data-global"].forEach((e=>{t.removeAttribute(e)})),t.setAttribute("data-decrypted-global","true"),t.setAttribute("data-decrypted-time",Date.now()),t.setAttribute("data-key-version","v4.0")}registerGlobalComponent(t){const e=t.id||`global_comp_${Date.now()}_${Math.random().toString(36).substr(2,12)}`;this.components.set(e,{element:t,decrypted:!0,timestamp:Date.now(),type:t.tagName,checksum:this.generateQuantumChecksum(t.outerHTML),location:window.location.href})}generateQuantumChecksum(t){let e=0n;for(let r=0;r<t.length;r++)e=(e<<8n)+BigInt(t.charCodeAt(r));const r=BigInt(Date.now()),n=e^r^(e>>17n);return n.toString(36).padStart(32,"0")}decryptScriptsGlobally(){document.querySelectorAll('script[type="text/encrypted"], script[secure-script], script[type="application/jonson"], script[type="application/mab"], script[type="application/global"], script[data-global-script]').forEach((t=>{const e=t.textContent;if(this.isQuantumEncrypted(e)){const r=this.xorSuperDecrypt(e,this.masterKey);r&&setTimeout((()=>{this.executeGlobalScript(t,r)}),50)}}))}executeGlobalScript(t,e){const r=document.createElement("script");Array.from(t.attributes).forEach((t=>{["type","secure-script","data-global-script"].includes(t.name)||r.setAttribute(t.name,t.value)})),r.setAttribute("nonce",this.generateQuantumNonce()),r.textContent=e;try{const n=t.parentNode;n&&(n.replaceChild(r,t),window.requestIdleCallback?window.requestIdleCallback((()=>{(0,eval)(e)})):setTimeout((()=>{(0,eval)(e)}),100))}catch(t){console.error("üî¥ Global script execution failed:",t),this.logSecurityEvent("global_script_failed",{error:t.message,scriptLength:e.length})}}generateQuantumNonce(){const t=Date.now().toString(36),e=Math.random().toString(36).substr(2,32),r=window.crypto&&window.crypto.getRandomValues?window.crypto.getRandomValues(new Uint8Array(16)):[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=Array.from(r).map((t=>t.toString(36))).join("");return`quantum_nonce_${t}_${e}_${n}`}setupUniversalObservers(){const t=new MutationObserver((t=>{let e=!1;t.forEach((t=>{t.addedNodes.forEach((t=>{1===t.nodeType&&this.containsQuantumEncrypted(t)&&(e=!0)}))})),e&&this.throttledMassScan()}));t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!1,characterData:!1});const e=new MutationObserver((t=>{t.forEach((t=>{"attributes"===t.type&&this.isGlobalSecurityAttribute(t.attributeName)&&this.debouncedMassDecrypt()}))}));e.observe(document.body,{attributes:!0,subtree:!0,attributeFilter:["data-encrypted","data-secure","secure-data","data-jonson","data-mab","data-global","data-quantum"]});window.PerformanceObserver&&new PerformanceObserver((t=>{t.getEntries().forEach((t=>{t.duration>500&&this.optimizePerformanceQuantum()}))})).observe({entryTypes:["longtask"]});this.observers={domObserver:t,attrObserver:e}}containsQuantumEncrypted(t){if(1===t.nodeType){const e=t.outerHTML;return e.includes("SEC_")||e.includes("ENC_")||e.includes("QUANTUM_")||t.hasAttribute("data-encrypted")||t.hasAttribute("data-secure")||t.hasAttribute("secure-data")||t.hasAttribute("data-jonson")||t.hasAttribute("data-mab")||t.hasAttribute("data-global")||t.hasAttribute("data-quantum")||!!t.querySelector&&t.querySelectorAll("[data-encrypted], [data-secure], [secure-data], [data-jonson], [data-mab], [data-global], [data-quantum]").length>0}return!1}isGlobalSecurityAttribute(t){return["data-encrypted","data-secure","secure-data","data-jonson","data-mab","data-global","data-quantum"].includes(t)}antiTamperingQuantum(){this.protectFunctionsQuantum(),this.quantumDebuggerProtection(),this.consoleQuantumProtection(),this.memoryQuantumProtection(),this.timingQuantumProtection(),this.integrityQuantumChecking(),this.hookQuantumProtection(),this.injectionProtection()}protectFunctionsQuantum(){["generateMultiLayerKey","xorSuperEncrypt","xorSuperDecrypt","processMassBatch","executeGlobalScript"].forEach((t=>{const e=this[t];"function"==typeof e&&(this[t]=function(...r){const n=(new Error).stack;if(n&&this.detectMaliciousStack(n))return this.logSecurityEvent("quantum_malicious_stack",{method:t,stack:n}),this.quantumSecurityFallback(t,r);const o=performance.now(),s=this.executeWithQuantumTimeout((()=>e.apply(this,r)),3e3,t),a=performance.now();return a-o>2e3&&this.logSecurityEvent("quantum_slow_execution",{method:t,time:a-o}),s},Object.defineProperty(this,t,{writable:!1,configurable:!1,enumerable:!1}))}))}detectMaliciousStack(t){const e=[/eval at/,/Function constructor/,/at Object\./,/at <anonymous>/,/at webpack/,/at node_modules/,/chrome-extension:/];return e.some((e=>e.test(t)))}executeWithQuantumTimeout(t,e,r){return new Promise(((n,o)=>{const s=setTimeout((()=>{this.logSecurityEvent("quantum_timeout",{method:r}),o(new Error(`Quantum function ${r} timeout`))}),e);try{const e=t();clearTimeout(s),n(e)}catch(t){clearTimeout(s),o(t)}})).catch((t=>this.quantumSecurityFallback(r,[])))}quantumSecurityFallback(t,e){switch(console.warn(`‚ö†Ô∏è Quantum security fallback triggered for ${t}`),t){case"xorSuperDecrypt":return this.tryAllBackupDecryption(e[0]);case"generateMultiLayerKey":return this.masterKeySystem.getCurrentKey();default:return this.generateFallbackKey()}}tryAllBackupDecryption(t){for(const[e,r]of this.backupSystems.entries())try{const e=this.xorSuperDecrypt(t,r);if(e&&e.length>0)return this.logSecurityEvent("backup_decryption_success",{backup:e}),e}catch(t){}return"[QUANTUM SECURE CONTENT]"}generateFallbackKey(){return"quantum_fallback_"+Date.now()+"_"+Math.random().toString(36).substr(2,24)}quantumDebuggerProtection(){const t=[()=>{},()=>{(0,eval)("debugger")},()=>{Function("debugger").call()},()=>{debugger},()=>{const t=Date.now();while(Date.now()-t<200){}}];setInterval((()=>{Math.random()<.05&&(performance.now()%2<.1&&try{const e=t[Math.floor(Math.random()*t.length)],r=performance.now();e();const n=performance.now();n-r>100&&this.securityViolation("quantum_debugger",{duration:n-r})}catch(t){})}),3e3+2e3*Math.random())}consoleQuantumProtection(){if(window.console){const t={...console};["log","warn","error","info","debug","table","trace","dir","group","groupEnd","time","timeEnd","count","assert"].forEach((e=>{"function"==typeof console[e]&&(console[e]=function(...r){const n=r.map((t=>"string"==typeof t?t.replace(/(SEC_|ENC_|QUANTUM_|JON_|MAB_|EXEC_|SCR_|GLOBAL_)[A-Za-z0-9+/=_\-\$]+/g,"[QUANTUM_DATA]").replace(/(masterKey|sessionId|backupKey|parameterizedKey|quantumKey)=[^,\s]+/g,"$1=[QUANTUM_REDACTED]"):t));return"error"!==e&&"warn"!==e||window.__secureVaultQuantum?.logSecurityEvent("console_"+e,{args:JSON.stringify(r)}),t[e].apply(this,n)},Object.defineProperty(console,e,{value:console[e],writable:!1,configurable:!1}))})),Object.defineProperty(window,"console",{value:console,writable:!1,configurable:!1})}}memoryQuantumProtection(){setInterval((()=>{try{if((!this.masterKey||"string"!=typeof this.masterKey||this.masterKey.length<48)&&this.securityViolation("invalid_quantum_key",{length:this.masterKey?.length}),this.sessionId&&this.sessionId.startsWith("sess_v4_")||this.securityViolation("invalid_quantum_session"),this.components.forEach(((t,e)=>{if(t.element&&t.decrypted){const r=this.generateQuantumChecksum(t.element.outerHTML);r!==t.checksum&&this.securityViolation("quantum_component_tampered",{id:e,expected:t.checksum,actual:r})}})),performance.memory){const t=performance.memory;t.usedJSHeapSize>.85*t.jsHeapSizeLimit&&this.quantumCleanupMemory()}}catch(t){this.securityViolation("quantum_memory_error",{error:t.message})}}),1e4)}quantumCleanupMemory(){const t=Date.now();this.components.forEach(((e,r)=>{t-e.timestamp>6e5&&this.components.delete(r)})),this.performanceLog.length>200&&(this.performanceLog=this.performanceLog.slice(-100)),this.securityMatrix.size>20&&{const t=new Map;let e=0;for(const[r,n]of this.securityMatrix){if(e<10){t.set(r,n),e++;continue}}this.securityMatrix=t},window.gc&&window.gc()}timingQuantumProtection(){const t={};["xorSuperDecrypt","xorSuperEncrypt","processMassBatch"].forEach((e=>{t[e]=this[e].bind(this),this[e]=function(...r){const n=performance.now(),o=t[e](...r),s=performance.now()-n;if(s<1){const t=10*Math.random()+10,e=performance.now();for(;performance.now()-e<t;);}return s>5e3&&this.logSecurityEvent("quantum_slow_execution",{method:e,time:s}),o}}))}integrityQuantumChecking(){setInterval((()=>{document.querySelectorAll("script,link[rel='stylesheet'],img").forEach((t=>{t.src&&!t.hasAttribute("data-quantum-checked")&&this.checkQuantumIntegrity(t)}))}),45e3)}checkQuantumIntegrity(t){const e=t.src;if(!e)return;fetch(e,{method:"HEAD",cache:"no-cache"}).then((r=>{const n=r.headers.get("etag")||r.headers.get("content-length"),o=t.getAttribute("data-quantum-etag");o!==n&&this.securityViolation("quantum_resource_modified",{src:e,expected:o,actual:n})})).catch((()=>{}))}hookQuantumProtection(){["fetch","XMLHttpRequest.prototype.send","setTimeout","setInterval","requestAnimationFrame","Promise.prototype.then","Object.defineProperty","Object.getOwnPropertyDescriptor"].forEach((t=>{try{if(t.includes("prototype")){const e=t.split("."),r=window[e[0]],n=e[2],o=r.prototype[n];Object.defineProperty(r.prototype,n,{value:function(...e){return e.filter((t=>"string"==typeof t)).forEach((e=>{(e.includes("SEC_")||e.includes("ENC_")||e.includes("QUANTUM_")||e.includes("masterKey")||e.includes("global_key"))&&this.logSecurityEvent("quantum_hook_attempt",{api:t,arg:e.substring(0,100)})})),o.apply(this,e)},writable:!1,configurable:!1})}else{const e=window[t];Object.defineProperty(window,t,{value:function(...t){return e.apply(this,t)},writable:!1,configurable:!1})}}catch(t){}}))}injectionProtection(){const t=this;["innerHTML","outerHTML","insertAdjacentHTML","document.write","document.writeln"].forEach((e=>{try{if(e.includes(".")){const r=e.split("."),n=window[r[0]],o=r[1],s=n.prototype[o];Object.defineProperty(n.prototype,o,{set:function(e){if("string"==typeof e&&(e.includes("SEC_")||e.includes("ENC_")||e.includes("QUANTUM_")||e.includes("GLOBAL_"))){const r=t.xorSuperDecrypt(e,t.masterKey);return r?s.call(this,r):s.call(this,"[QUANTUM INJECTION BLOCKED]")}return s.call(this,e)},writable:!1,configurable:!1})}else{const r=window[e];Object.defineProperty(window,e,{value:function(t){return r.call(this,t)},writable:!1,configurable:!1})}}catch(t){}}))}securityViolation(t,e={}){console.warn(`üö® QUANTUM SECURITY VIOLATION: ${t}`,e),this.logSecurityEvent("quantum_security_violation",{reason:t,...e}),this.components.forEach((e=>{e.element&&e.decrypted&&(e.element.textContent="üîí [QUANTUM SECURED CONTENT]",e.element.style.cssText="color:#ff0066 !important;background-color:#110011 !important;border:2px solid #ff00ff !important;padding:10px;font-family:monospace !important;",e.element.setAttribute("data-quantum-violation",t))})),this.generateMultiLayerKey(),document.dispatchEvent(new CustomEvent("quantum-security-violation",{detail:{reason:t,timestamp:Date.now(),data:e}}))}logSecurityEvent(t,e={}){const r={type:t,timestamp:Date.now(),sessionId:this.sessionId,url:window.location.href,quantum:!0,...e};return this.securityMatrix.get("layer_0")?.set(`event_${Date.now()}`,r),r}stealthModeQuantum(){const t="_qv"+Math.random().toString(36).substr(2,16),e="__qm_"+Math.random().toString(36).substr(2,14);window[t]=this,Object.defineProperty(window,e,{get:()=>this,set:()=>{},configurable:!1,enumerable:!1}),setTimeout((()=>{try{delete window[t],delete window[e]}catch(t){}}),800+2200*Math.random()),Object.defineProperty(window,"SecureVaultEnhanced",{value:null,writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(window,"__secureVaultQuantum",{get:()=>this,set:()=>{},configurable:!1,enumerable:!1})}optimizePerformanceQuantum(){this.throttledMassScan=this.quantumThrottle(this.scanAndDecryptMassively.bind(this),500),this.debouncedMassDecrypt=this.quantumDebounce(this.processMassBatch.bind(this),300),this.regexCache={quantumPattern:/^(SEC_|ENC_|QUANTUM_|JON_|MAB_|HTML_|TEXT_|EXEC_|SCR_|GLOBAL_)/,securityAttrPattern:/^(data-encrypted|data-secure|secure-data|data-jonson|data-mab|data-global|data-quantum)$/,sensitivePattern:/(SEC_|ENC_|QUANTUM_|JON_|MAB_|EXEC_|SCR_|GLOBAL_)[A-Za-z0-9+/=_\-\$]+/g},"requestIdleCallback"in window&&requestIdleCallback((()=>{this.backgroundQuantumOptimization()}),{timeout:1e4})}quantumThrottle(t,e){let r,n,o=0;return function(...s){const i=this;return n?(clearTimeout(r),r=setTimeout((function(){Date.now()-n>=e&&(t.apply(i,s),n=Date.now(),o++)}),Math.max(e-(Date.now()-n),0))):(t.apply(i,s),n=Date.now(),o++),o>100&&(this.logSecurityEvent("quantum_throttle_high",{calls:o}),o=0),this}}quantumDebounce(t,e,r=!1){let n,o=0;return function(...s){const i=this,a=r&&!n;clearTimeout(n),n=setTimeout((function(){n=null,r||(t.apply(i,s),o++)}),e),a&&(t.apply(i,s),o++),o>50&&(this.logSecurityEvent("quantum_debounce_high",{calls:o}),o=0),this}}backgroundQuantumOptimization(){const t=Date.now();if(this.securityMatrix.forEach(((e,r)=>{const n=e.get("timestamp")||0;t-n>36e5&&this.securityMatrix.delete(r)})),this.components.size>2e3){const t=new Map;let e=0;for(const[r,n]of this.components)e<500&&(t.set(r,n),e++);this.components=t}}setupHealthMonitorV2(){setInterval((()=>{const t={components:this.components.size,securityLayers:this.securityLayers,performanceLogs:this.performanceLog.length,securityMatrixSize:this.securityMatrix.size,masterKeySystemKeys:this.masterKeySystem.parameterizedKeys.size,backupSystems:this.backupSystems.size,memory:performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1024/1024),total:Math.round(performance.memory.jsHeapSizeLimit/1024/1024),ratio:(performance.memory.usedJSHeapSize/performance.memory.jsHeapSizeLimit).toFixed(2)}:null,uptime:Date.now()-parseInt(this.sessionId.split("_")[2])};(t.components>1500||t.memory&&t.memory.ratio>.8)&&this.logSecurityEvent("quantum_health_warning",t),this.healthStatus=t}),3e4)}initializeAutoKeyRotation(){setInterval((()=>{this.keyRotationCount++,this.logSecurityEvent("quantum_key_rotation_start",{count:this.keyRotationCount});const t=this.masterKey;this.generateMultiLayerKey();const e=this.masterKeySystem.getCurrentKey();this.masterKeySystem.enableMassDistribution(),this.logSecurityEvent("quantum_key_rotation_complete",{oldKeyLength:t?.length,newKeyLength:this.masterKey?.length,systemKey:e?.substring(0,16)+"..."})}),9e5)}setupMemoryGuardV2(){window.addEventListener("pagehide",(()=>{this.quantumCleanup()})),document.addEventListener("visibilitychange",(()=>{document.hidden&&this.backgroundQuantumCleanup()})),window.addEventListener("beforeunload",((t)=>{this.quantumCleanup(),t.returnValue="Are you sure you want to leave?"}))}quantumCleanup(){this.observers&&Object.values(this.observers).forEach((t=>{t.disconnect()})),this.components.clear(),this.backupSystems.clear(),this.securityMatrix.clear(),this.performanceLog=[],this.masterKey=null,this.masterKeySystem.disableMassDistribution()}backgroundQuantumCleanup(){if(this.components.size>300){const t=new Map;let e=0;for(const[r,n]of this.components)(e<100||Date.now()-n.timestamp<18e5)&&(t.set(r,n),e++);this.components=t}}encryptDataQuantum(t,e=!1){return`QUANTUM_${e?"HTML_":"TEXT_"}`+this.xorSuperEncrypt(t,this.masterKey)}encryptScriptQuantum(t){return`EXEC_QUANTUM_`+this.xorSuperEncrypt(t,this.masterKey)}injectGlobalKeyAccess(){const t=document.createElement("script");t.textContent=`window.getGlobalMasterKey=function(){return window.__secureVaultQuantum?.masterKeySystem?.getCurrentKey()||"GLOBAL_KEY_UNAVAILABLE"};window.getAllGlobalKeys=function(){return window.__secureVaultQuantum?.masterKeySystem?.getAllKeys()||[]};window.enableMassKeyDistribution=function(){return window.__secureVaultQuantum?.masterKeySystem?.enableMassDistribution()};window.disableMassKeyDistribution=function(){return window.__secureVaultQuantum?.masterKeySystem?.disableMassDistribution()};window.getQuantumSecurityStatus=function(){return window.__secureVaultQuantum?.getStatus()||{}};`;document.head.appendChild(t),setTimeout((()=>{try{document.head.removeChild(t)}catch(t){}}),100)}encryptData(t,e=!1){return this.encryptDataQuantum(t,e)}encryptScript(t){return this.encryptScriptQuantum(t)}autoRegisterGlobal(){document.querySelectorAll("[data-auto-encrypt], [data-jonson-auto], [data-mab-auto], [data-quantum-auto], [data-global-auto]").forEach((t=>{if(!t.hasAttribute("data-encrypted")&&!t.hasAttribute("data-secure")&&!t.hasAttribute("data-global")){const e=t.innerHTML||t.textContent;if(e&&e.trim().length>0){const r=t.hasAttribute("data-html")||"DIV"===t.tagName||"SPAN"===t.tagName||"P"===t.tagName||"SECTION"===t.tagName,n=this.encryptDataQuantum(e,r);t.setAttribute("data-global",n),t.innerHTML="",this.throttledMassScan()}}}))}registerGlobalComponent(t,e,r=!1){const n=document.getElementById(t);return!!n&&(n.setAttribute("data-global",e),r&&n.setAttribute("data-html","true"),this.throttledMassScan(),!0)}getStatus(){return{sessionId:this.sessionId,components:this.components.size,securityLayers:this.securityLayers,securityMatrixSize:this.securityMatrix.size,masterKeySystem:{keys:this.masterKeySystem.parameterizedKeys.size,distributionEnabled:this.masterKeySystem.massDistributionEnabled},backupSystems:this.backupSystems.size,health:this.healthStatus,keyRotationCount:this.keyRotationCount,version:"4.0-quantum-global"}}}const t=()=>{setTimeout((()=>{try{const t=new SecureVaultEnhanced;window.__secureVaultQuantum=t,window.__jonsonQuantumSecure=t,window.__mabQuantumSecurity=t,console.log("‚úÖ SecureVault Quantum v4.0 initialized with Global Key System"),setTimeout((()=>t.autoRegisterGlobal()),300);const e=performance.now();window.secureEncryptQuantum=function(t,r){return window.__secureVaultQuantum?window.__secureVaultQuantum.encryptDataQuantum(t,r):t},window.secureDecryptQuantum=function(t){if(window.__secureVaultQuantum&&t){const e=t.replace(/^(SEC_|ENC_|QUANTUM_|JON_|MAB_|HTML_|TEXT_|EXEC_|SCR_|GLOBAL_)/,"");return window.__secureVaultQuantum.xorSuperDecrypt(e,window.__secureVaultQuantum.masterKey)}return null},window.quantumBatchEncrypt=function(t){if(!window.__secureVaultQuantum||!Array.isArray(t))return t;const e=t.map((t=>window.__secureVaultQuantum.encryptDataQuantum(t)));return e},window.distributeGlobalKeys=function(){return window.__secureVaultQuantum?.masterKeySystem?.enableMassDistribution()};const r=performance.now();console.log(`‚ö° Quantum system ready in ${(r-e).toFixed(2)}ms`)}catch(t){console.error("üî¥ Quantum system failed:",t)}}),50)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),"undefined"!=typeof window&&(window.SecureVaultEnhanced=SecureVaultEnhanced)}();